<project name="WebMain" basedir="." default="swf">
	
	<taskdef resource="flexTasks.tasks" classpath="${FLEX_HOME}/ant/lib/flexTasks.jar" /> 
	
	<property name="FLEX_HOME" value="${env.FLEX_HOME}" />
	<property environment="env" />
	<fail unless="env.FLEX_HOME" message="FLEX_HOME needs to be defined as an environment variable or in the Ant build." />
	<!-- Copy Flex SDK location from environment variable. This can be set manually instead. -->
	<property file="build.properties" />

	<target name="clean" description="Remove folders generated by the build.">
		<echo>[clean] Removing generated folders.</echo>
		<delete dir="${output.dir}" quiet="true" includeEmptyDirs="true" />
		<delete dir="${dist.dir}" quiet="true" includeEmptyDirs="true" />
	</target>

	<target name="swf" depends="clean" description="Compile AS3 code into a SWF.">
		<echo>[swf] Building SWF</echo>
		<echo>[swf] Using Flex SDK at: ${FLEX_HOME}</echo>
		<mkdir dir="${output.dir}" />
		<java jar="${FLEX_HOME}/lib/mxmlc.jar" dir="." fork="true" failonerror="true">
			<arg value="+flexlib=${FLEX_HOME}/frameworks" />
			<arg value="-incremental=true" />

			<arg value="-source-path+=${src.dir}" />
			<!-- Include all classes in this path. -->
			<arg value="-include-sources=${src.dir}/${package.dir}" />
			<!-- Link in classes from swc library (only those used). -->
			<arg value="-external-library-path+=${libs.dir}" />

			<arg value="-output=${output.swf}" />
		</java>
	</target>

	<!--<target name="mxmlc"></target>-->
</project>
